<div class="content">
  <div class="timetable-container">
    <div class="timetable-header">
      <h2>üìÖ L·ªãch h·ªçc, l·ªãch thi theo tu·∫ßn</h2>
      <div class="controls">
        <label>Ch·ªçn tu·∫ßn:</label>
        <input 
          type="date" 
          [ngModel]="currentDate | date:'yyyy-MM-dd'" 
          (ngModelChange)="onDateChange($event)" 
        />
        <button class="btn blue-btn" (click)="changeWeek(-7)">‚óÄ Tr∆∞·ªõc</button>
        <button class="btn blue-btn" (click)="changeWeek(7)">Ti·∫øp ‚ñ∂</button>
      </div>
    </div>
    
    <div *ngIf="isLoading" class="alert alert-info">ƒêang t·∫£i l·ªãch h·ªçc...</div>
    <div *ngIf="errorMessage" class="alert alert-danger">{{ errorMessage }}</div>

    <div class="timetable-scroll" *ngIf="!isLoading && !errorMessage">
      <table class="timetable-table">
        <thead>
          <tr>
            <th>Ca h·ªçc</th>
            <th *ngFor="let day of weekDays; let i = index">
              {{ dayNames[day.getDay()] }}<br />
              {{ day | date:'dd/MM/yyyy' }}
            </th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let session of sessions">
            <td class="session">{{ session.name }}</td>
            
            <td *ngFor="let day of weekDays; let i = index">
              <ng-container *ngIf="weeklySchedule[dayNames[day.getDay()]]">
                  <div 
                    *ngFor="let course of getScheduleByDayAndSession(dayNames[day.getDay()], session.name)" 
                    [class]="'course ' + course.loai_phong"
                  >
                    <b>{{ course.ten_hp }}</b>
                    {{ course.ma_lop_hp }}<br />
                    Ti·∫øt: {{ course.tiet_bat_dau }}-{{ course.tiet_ket_thuc }}<br />
                    Ph√≤ng: {{ course.phong }}
                    <span *ngIf="course.trang_thai === 'Ngh·ªâ'">(Ngh·ªâ)</span>
                    <br />
                    Gi·∫£ng vi√™n: {{ course.ten_gv }}
                  </div>
              </ng-container>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    
    <div class="legend">
      <div class="legend-item"><span class="box theory"></span> L√Ω thuy·∫øt</div>
      <div class="legend-item"><span class="box lab"></span> Th·ª±c h√†nh</div>
      <div class="legend-item"><span class="box online"></span> Tr·ª±c tuy·∫øn</div>
      <div class="legend-item"><span class="box exam"></span> L·ªãch thi</div>
      <div class="legend-item"><span class="box off"></span> Ngh·ªâ h·ªçc</div>
    </div>
  </div>
</div>